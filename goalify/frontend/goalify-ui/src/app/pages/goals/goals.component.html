<div class="flex flex-col gap-8 h-full">
  <app-filter-pills
    type="goals"
    [selectedValue]="filterStatus()"
    (valueChange)="setFilter($event)" />

  @if (error()) {
    <div class="rounded-xl border border-border bg-surface-alt text-ink px-4 py-3 text-sm">{{ error() }}</div>
  }

  @if (loading()) {
    <p class="text-muted text-[15px]">Loading...</p>
  }
  @if (filterStatus() === 'TODO') {
    <app-goal-todo-view [goals]="goals()" (editGoal)="openEditModal($event)" />
    <button type="button" class="fixed bottom-8 right-8 size-14 rounded-2xl bg-peach text-white flex items-center justify-center transition-all duration-200 hover:bg-peach-soft focus:outline-none focus:ring-2 focus:ring-peach focus:ring-offset-2 focus:ring-offset-surface shadow-warm-md" aria-label="Add a goal" (click)="openCreateModal()">
      <span class="text-2xl font-light leading-none">+</span>
    </button>
  
    @if (modalOpen()) {
      <app-goal-form-modal
    [mode]="modalOpen()!"
    [goal]="goalToEdit()"
    [filterStatus]="filterStatus()"
    (close)="closeModal()"
    (saved)="onModalSaved($event)"
    (delete)="onDelete($event)"
    />}
  }
  @if (filterStatus() === 'ONGOING') {
    <app-goal-ongoing-view [goals]="goals()" (editGoal)="openEditModal($event)" />
    @if (modalOpen()) {
      <app-goal-form-modal
    [mode]="modalOpen()!"
    [goal]="goalToEdit()"
    [filterStatus]="filterStatus()"
    (close)="closeModal()"
    (saved)="onModalSaved($event)"
    (delete)="onDelete($event)"
    />}
  }
  @if (filterStatus() === 'MAINTENANCE') {
    <app-goal-maintenance-view [goals]="goals()" (editGoal)="openEditModal($event)" />
  }
  @if (filterStatus() === 'DONE') {
    <app-goal-done-view [goals]="goals()" (editGoal)="openEditModal($event)" />
  }
</div>
